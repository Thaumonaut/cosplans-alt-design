import{be as r,bf as n}from"./CpdYPIwz.js";import{a as m}from"./BZeYbtOm.js";function v(){const t={mode:"system"},{subscribe:e,set:o,update:l}=r(t);return{subscribe:e,set:o,update:l,init:()=>{{const s=localStorage.getItem("theme");if(s)try{const a=JSON.parse(s);o(a),u(a.mode)}catch{o(t)}else u(t.mode)}}}}const k=v();function u(t){const e=document.documentElement;if(t==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)").matches;e.classList.toggle("dark",o)}else e.classList.toggle("dark",t==="dark")}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{k.update(e=>(e.mode==="system"&&u("system"),e))});function T(){const t={theme:{mode:"system"},notifications:!0,autoSave:!0},{subscribe:e,set:o,update:l}=r(t);return{subscribe:e,set:o,update:l,init:()=>{{const s=localStorage.getItem("appSettings");if(s)try{const a=JSON.parse(s);o(a)}catch{o(t)}}}}}const L=T(),c=r([]),p=r(!1),g=r(null);n(c,t=>t.filter(e=>e.status==="in-progress"));n(c,t=>t.filter(e=>e.status==="completed"));n(c,t=>t.filter(e=>e.status==="archived"));n(c,t=>t.filter(e=>e.status==="idea"));n(c,t=>t.filter(e=>e.status==="planning"));n(c,t=>{const e=t.length,o=t.filter(a=>a.status==="completed").length,l=t.filter(a=>a.status==="in-progress").length,s=t.filter(a=>a.deadline&&new Date(a.deadline)<new Date&&a.status!=="completed").length;return{total:e,completed:o,inProgress:l,overdue:s,completionRate:e>0?Math.round(o/e*100):0}});async function b(t){p.set(!0),g.set(null);try{const e=await m.getProjects(t);if(e.success)c.set(e.data);else throw new Error(e.message||"Failed to load projects")}catch(e){const o=e instanceof Error?e.message:"Failed to load projects";g.set(o),console.error("Failed to load projects:",e)}finally{p.set(!1)}}function j(t){c.update(e=>{const o={...t,id:Date.now(),createdAt:new Date,updatedAt:new Date};return[...e,o]})}const i=r([]),w=r(!1),h=r(null);n(i,t=>t.filter(e=>e.completed));n(i,t=>t.filter(e=>!e.completed));n(i,t=>t.filter(e=>!e.completed&&e.dueDate&&new Date(e.dueDate)<new Date));n(i,t=>({high:t.filter(e=>e.priority==="high"&&!e.completed),medium:t.filter(e=>e.priority==="medium"&&!e.completed),low:t.filter(e=>e.priority==="low"&&!e.completed)}));n(i,t=>{const e=t.length,o=t.filter(s=>s.completed).length,l=t.filter(s=>!s.completed&&s.dueDate&&new Date(s.dueDate)<new Date).length;return{total:e,completed:o,pending:e-o,overdue:l,completionRate:e>0?Math.round(o/e*100):0}});async function M(t){w.set(!0),h.set(null);try{const e=await m.getTasks(t);if(e.success)i.set(e.data);else throw new Error(e.message||"Failed to load tasks")}catch(e){const o=e instanceof Error?e.message:"Failed to load tasks";h.set(o),console.error("Failed to load tasks:",e)}finally{w.set(!1)}}function P(t){i.update(e=>e.map(o=>o.id===t?{...o,completed:!o.completed}:o))}function N(t){i.update(e=>{const o={...t,id:Date.now()};return[...e,o]})}const d=r([]),D=r(!1),y=r(null);n(d,t=>t.filter(e=>new Date(e.date)>=new Date).sort((e,o)=>new Date(e.date).getTime()-new Date(o.date).getTime()));n(d,t=>t.filter(e=>new Date(e.date)<new Date).sort((e,o)=>new Date(o.date).getTime()-new Date(e.date).getTime()));n(d,t=>({convention:t.filter(e=>e.type==="convention"),photoshoot:t.filter(e=>e.type==="photoshoot"),deadline:t.filter(e=>e.type==="deadline"),other:t.filter(e=>e.type==="other")}));n(d,t=>{const e=t.length,o=t.filter(s=>new Date(s.date)>=new Date).length,l=t.filter(s=>{const a=new Date(s.date),f=new Date,E=new Date(f.getTime()+10080*60*1e3);return a>=f&&a<=E}).length;return{total:e,upcoming:o,past:e-o,thisWeek:l}});async function A(t){D.set(!0),y.set(null);try{const e=await m.getEvents(t);if(e.success)d.set(e.data);else throw new Error(e.message||"Failed to load events")}catch(e){const o=e instanceof Error?e.message:"Failed to load events";y.set(o),console.error("Failed to load events:",e)}finally{D.set(!1)}}function C(t){d.update(e=>{const o={...t,id:Date.now()};return[...e,o]})}export{w as a,h as b,P as c,k as d,d as e,L as f,b as g,A as h,j as i,N as j,C as k,M as l,c as p,i as t};
